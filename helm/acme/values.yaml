# UI Service Configuration
ui:
  image:
    repository: acme
    tag: latest
  replicas: 2

# API Service Configuration
api:
  image:
    repository: acme-api
    tag: latest
  replicas: 2
  environment:
    - name: POSTGRES_URL
      value: "postgresql://postgres:postgres@postgres-primary.database.svc.cluster.local:5432/acme"
    - name: METRICS_URL
      value: "http://opentelemetry-collector.observability.svc.cluster.local:4318"

service:
  type: LoadBalancer
  port: 80

ingress:
  enabled: true
  className: nginx
  hosts:
    - host: www.acme.com
      paths:
        - path: /api
          pathType: Prefix
          service: acme-api
          port: http
        - path: /
          pathType: Prefix
          service: acme
          port: http

# Horizontal Pod Autoscaler
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 20                    # Support higher scaling for .NET workloads
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70     # .NET responds well to CPU scaling
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80     # Scale early to avoid OOM kills

resources:
  requests:
    cpu: 250m          # .NET Core runtime baseline ~100-150m + headroom
    memory: 256Mi      # .NET GC + heap + app buffer
  limits:
    cpu: 1000m         # 4x request for .NET workload bursts
    memory: 1Gi        # 4x request, critical for OOM prevention
